<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" th:href="@{/resources/css/login.css}" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sunn-us/SUITE/fonts/static/woff2/SUITE.css">

    <title>지우자:지금우리자리는</title>
</head>
<body>
    <!-- header -->
    <header class="hd-container">
        <ul>
            <li><a href="">홈버튼</a></li>
            <!-- <li><a href="">로그인</a></li>
            <li><a href="">회원가입</a></li>
            <li><a href="">마이페이지</a></li> -->
        </ul>
    </header>
    <nav class="nav-container">
        <ul>
            <li>예매하기</li>
            <!-- <li>조회/ 환불하기</li>
            <li>이용안내</li>
            <li>고객안내</li> -->
        </ul>
    </nav>

    <!-- section -->
    <section class="sec-container">
        <article>
            <h2 class="login-name">로그인</h2>
            <div class="login">
                <p class="info">회원 정보 입력</p>
                <div>
                    <div class="inset">
                        <form method="post">
                            <p class="insert">
                                <label for="username">아이디 </label>
                                <input id="username" type="text" name="username">

                            </p>

                            <p class="insert">
                                <label for="password">비밀번호 </label>
                                <input  id="password" type="password" name="password">
                            </p>

                            <input type="button" onclick="login();" value="로그인" class="submit-btn" />
                        </form>

                    </div>

                    <ul class="find">
                        <li>
                            <p><a href="">아이디 찾기 </a>/<a href=""> 비밀번호 찾기</a></p>
                        </li>
                        <li class="membership"><p><a href="/JIUJA/join/membership">회원가입 하기 ></a></p></li>
                    </ul>
                </div>
            </div>
        </article>
    </section>
    <footer>
        <p>copy</p>
    </footer>

<script src="http://code.jquery.com/jquery-3.5.1.min.js"></script>
<script th:inline="javascript">
    /*<![CDATA[*/

        $(function() {
			// 아이디, 비밀번호 엔터키 반영
			$('#username, #password').on('keyup', function(e) {
				if(e.keyCode === 13) {
					login();
				}
			});
		});

		// 로그인
        function login() {

			const username = document.getElementById('username');
			const password = document.getElementById('password');

        	if (!username.value.trim()) {
        		alert('아이디를 입력해 주세요.');
        		username.focus();
        		return false;
        	}
        	if (!password.value.trim()) {
                alert('비밀번호를 입력해 주세요.');
                password.focus();
                return false;
            }

        	const params = { username: username.value, password: password.value };

        	$.ajax({
                url: '/login',
                type: 'POST',
                dataType: 'json',
                data: JSON.stringify(params),
                contentType: 'application/json; charset=UTF-8',
                async: false,
                success: function(response) {
                    location.href = "/JIUJA/main";
                },
                error: function(request, status, error) {
                    alert('아이디와 비밀번호를 확인해 주세요.');
                }
            });
        }


    /*]]>*/
</script>

</body>
</html>